import{useApi as e,useStores as t,defineDisplay as a}from"@directus/extensions-sdk";import{defineComponent as n,ref as i,onMounted as r,onUnmounted as d,resolveComponent as l,openBlock as o,createBlock as c,withModifiers as s,withCtx as u,createTextVNode as m,createElementBlock as p,toDisplayString as b}from"vue";import{useRouter as f}from"vue-router";import{defineStore as h}from"pinia";const _=h({id:"routerStore",state:()=>({path:"/content/client_product_mapping?bookmark=1502"}),getters:{gettingPath(){return this.path}},actions:{postingPath(e){this.path=e}}});var y={vouchers:"Vouchers",giftcard:"Gift Card",field:{client_brand_commercial:["flow","brand_name","discount","status"]}};const v={key:1};var g=n({__name:"display",props:{display:{type:Object,required:!0},options:{type:Object,required:!0},interface:{type:Object,required:!0},interfaceOptions:{type:Object,required:!0},value:{type:Object,required:!0},type:{type:Object,required:!0},collection:{type:Object,required:!0},field:{type:Object,required:!0},item:{type:Object,required:!0},primaryKeyField:{type:Object,required:!0},backbutton:{type:Object,required:!0},iconElement:{type:Object,required:!0},firstChildElement:{type:Object,required:!0},secondChildElement:{type:Object,required:!0},thirdChildElement:{type:Object,required:!0},rounded:{type:Object,required:!0},background:{type:Object,required:!0}},setup(a){const n=e(),{useUserStore:h,usePresetsStore:g}=t(),k=h(),q=g(),C=a,E=f(),O=i(null),S=i(null),j=_();r((async()=>{var e;const t=document.querySelector("header"),a=null==t?void 0:t.firstElementChild;if(!(null==a?void 0:a.classList.contains("sd-v-button"))&&C.backbutton){const e=document.createElement("div"),a=document.createElement("button"),n=document.createElement("i"),i=document.createElement("span"),r=document.createElement("span");r.classList.add("v-icon"),r.setAttribute(C.secondChildElement,""),r.setAttribute(C.thirdChildElement,""),r.classList.add("content"),i.setAttribute(C.firstChildElement,""),n.setAttribute("data-icon","arrow_back"),n.setAttribute(C.iconElement,""),a.classList.add("button"),a.classList.add("align-center"),a.classList.add("icon"),a.classList.add("normal"),e.classList.add("v-button"),e.classList.add("sd-v-button"),e.classList.add("rounded"),e.setAttribute("data-v-28d526fe",""),e.classList.add("header-icon"),e.classList.add("secondary"),a.setAttribute("data-v-28d526fe",""),r.appendChild(n),i.appendChild(r),a.appendChild(i),e.appendChild(a),a.addEventListener("click",(function(){E.push(j.gettingPath)})),null==t||t.insertBefore(e,t.firstChild)}if(!C.backbutton){const t=await n.get(`/items/client_product_mapping/${null==(e=C.item)?void 0:e.id}`),a={filter:{user:{_eq:k.currentUser.id},collection:{_eq:"client_brand_commercial"}}},i=await n.get("/presets",{params:a});t.data.data.product!=y.vouchers&&t.data.data.product!=y.giftcard||(j.postingPath(E.currentRoute.value.fullPath),O.value=t.data.data,S.value=i.data.data)}})),d((async()=>{const e=document.getElementsByClassName("sd-v-button");Array.from(e).forEach((function(e){e.remove()}))}));return(e,t)=>{var a,i;const r=l("v-button");return O.value&&(null==(i=null==(a=O.value)?void 0:a.client_product_mapping)?void 0:i.length)>0?(o(),c(r,{key:0,rounded:e.rounded,warning:"","x-small":"",onClick:t[0]||(t[0]=s((e=>(()=>{var e,t,a,i;if(S.value[0]&&(null==(e=C.item)?void 0:e.id)){const e=S.value[0];e.layout_query={tabular:{fields:y.field.client_brand_commercial}},e.filter={_and:[{client_product_id:{id:{_eq:null==(t=C.item)?void 0:t.id}}}]},e.search="";const i={last_page:"/content/client_brand_commercial"},r={id:e.id,layout:"sd-tabular",user:k.currentUser.id,collection:"client_brand_commercial",filter:{_and:[{client_product_id:{id:{_eq:null==(a=C.item)?void 0:a.id}}}]},layout_query:{"sd-tabular":{fields:["flow","brand_name","discount","status"]}}};n.patch("/users/me/track/page",i).then((async t=>{q.update(e.id,r),q.clearLocalSave(r),q.saveLocal(r),E.push("/content/client_brand_commercial")}))}else{const e={layout:"sd-tabular",bookmark:null,user:k.currentUser.id,role:null,collection:"client_brand_commercial",search:null,layout_query:{tabular:{fields:y.field.client_brand_commercial}},layout_options:{tabular:{widths:{}}},refresh_interval:null,filter:{_and:[{client_product_id:{id:{_eq:null==(i=C.item)?void 0:i.id}}}]},icon:"bookmark_outline",color:null},t={last_page:"/content/client_brand_commercial"};n.patch("/users/me/track/page",t).then((t=>{q.create(e),q.clearLocalSave(e),q.saveLocal(e),E.push("/content/client_brand_commercial")}))}})()),["stop"]))},{default:u((()=>[m(" View Brands ")])),_:1},8,["rounded"])):e.backbutton?(o(),p("div",v,b(e.value),1)):(o(),c(r,{key:2,rounded:e.rounded,secondary:"","x-small":"",disabled:""},{default:u((()=>[m("No Brands")])),_:1},8,["rounded"]))}}});g.__file="src/display.vue";var k=a({id:"custom-button",name:"SD ShakePe",icon:"box",description:"Display for ShakePe Order",component:g,options:e=>[{field:"backbutton",name:"Back Button",type:"boolean",meta:{width:"half",interface:"boolean",options:{label:"Enable of Back Button"}},schema:{default_value:!1}},{field:"rounded",name:"Rounded Button",type:"boolean",meta:{width:"half",interface:"boolean",options:{label:"Rounded Button"}},schema:{default_value:!1}},{field:"background",name:"Background",type:"string",meta:{interface:"select-color",width:"half"}},{field:"iconElement",name:"Icon CSS",type:"string",meta:{width:"half",interface:"input"}},{field:"firstChildElement",name:"First Child CSS",type:"string",meta:{width:"half",interface:"input"}},{field:"secondChildElement",name:"Second Child CSS",type:"string",meta:{width:"half",interface:"input"}},{field:"thirdChildElement",name:"Third Child CSS",type:"string",meta:{width:"half",interface:"input"}}],types:["string"]});export{k as default};
