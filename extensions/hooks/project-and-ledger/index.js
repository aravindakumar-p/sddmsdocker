"use strict";var a=({filter:a,action:e},{services:t,getSchema:c,exceptions:n})=>{const{ItemsService:l,UsersService:o}=t;a("projects.items.update",(async(a,{keys:e,collection:t},{schema:n,accountability:o})=>{try{const t=new l("projects",{schema:await c(),accountability:{admin:!0}});if(a.Load_wallent_balance){const c=await t.readByQuery({filter:{project_name:{_in:e}},fields:["*"]});if(0!=c.length){let e=c[0].wallet_balance;a.wallet_balance=a.Load_wallent_balance+e}}}catch(a){console.log("error---\x3e",a)}})),e("projects.items.update",(async(a,{schema:e,accountability:t})=>{try{const e=new l("projects_Ledger",{schema:await c(),accountability:{admin:!0}});a.payload.Load_wallent_balance&&await e.createOne({amount:a.payload.Load_wallent_balance,project:a.keys[0],ledger_type:"credit"})}catch(a){!async function(a,e,t){try{let e={};const t=new l("backend_logs",{schema:await c(),accountability:{admin:!0}});e.log=a,await t.createOne({log:e})}catch(a){}}(a)}}))};module.exports=a;
